<!DOCTYPE html>
<html>
<head>
  <title>SSP Home</title>
  <style>
    body { margin: 0; background: black; color: white; }
    iframe { width: 100vw; height: 100vh; border: none; }
    #adminBtn { position: fixed; top: 10px; right: 10px; z-index: 9999; }
    #adminPanel {
      display: none;
      position: fixed;
      top: 50px;
      right: 10px;
      background: #111;
      border: 1px solid purple;
      padding: 10px;
      max-height: 80vh;
      overflow: auto;
      z-index: 9999;
    }
  </style>
</head>
<body>

<button id="adminBtn" hidden>Admin</button>
<div id="adminPanel"></div>

<iframe src="https://sspv2play.neocities.org/home"></iframe>

<script>
const role = localStorage.getItem("role");
const btn = document.getElementById("adminBtn");
const panel = document.getElementById("adminPanel");

if (role === "admin") {
  btn.hidden = false;

  btn.onclick = async () => {
    panel.style.display = panel.style.display === "block" ? "none" : "block";

    const res = await fetch("/api/admin/users?admin=true");
    const users = await res.json();

    panel.innerHTML = users.map(u => `
      <div>
        ${u.username} (${u.banned ? "BANNED" : "ACTIVE"})
        <button onclick="toggle(${u.id}, ${!u.banned})">
          ${u.banned ? "Unban" : "Ban"}
        </button>
      </div>
    `).join("");
  };
}

async function toggle(id, banned) {
  await fetch("/api/admin/ban", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ admin: true, userId: id, banned })
  });
  location.reload();
}
</script>

</body>
</html>
